<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Efrem Raimondo's Cookbook</title>
  <meta name="description" content="No‑nonsense recipes by Efrem Raimondo. Simple search, clean index, and fast navigation." />
  <meta name="theme-color" content="#444444" />
  <style>
    :root{
      --bg:#e6e6e6; /* softer than pure #d3d3d3 */
      --card:#ffffff;
      --ink:#222;
      --muted:#666;
      --brand:#ff13f0; /* your hover color */
      --shadow:0 3px 6px rgba(0,0,0,.1);
      --shadow-lg:0 6px 16px rgba(0,0,0,.16);
      --radius:12px;
    }
    *{box-sizing:border-box}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;line-height:1.6;margin:0;background:var(--bg);color:var(--ink)}
    header{background:#444;color:#fff;padding:28px 16px;text-align:center}
    header h1{margin:.2rem 0 0;font-size:1.8rem}
    header p{margin:.3rem 0 0;color:#e8e8e8}

    .container{max-width:1100px;margin:0 auto;padding:20px}

    /* Search row */
    .tools{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    #search-bar{flex:1 1 360px;padding:12px 14px;border-radius:10px;border:1px solid #ccc;font-size:16px;outline:none}
    #search-bar:focus{border-color:#999;box-shadow:0 0 0 3px rgba(0,0,0,.06)}
    #count{color:var(--muted);font-size:.95rem}

    /* Index grid */
    #recipe-index{display:grid;grid-template-columns:1fr;gap:14px;list-style:none;padding:0;margin:18px 0}
    @media (min-width: 700px){#recipe-index{grid-template-columns:1fr 1fr}}
    @media (min-width: 1000px){#recipe-index{grid-template-columns:1fr 1fr 1fr}}
    @media (min-width: 1400px){#recipe-index{grid-template-columns:1fr 1fr 1fr 1fr}}

    #recipe-index li{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:14px 16px;transition:transform .15s ease, box-shadow .15s ease}
    #recipe-index li:hover{transform:translateY(-2px);box-shadow:var(--shadow-lg)}
    #recipe-index a{display:block;text-decoration:none;color:#333;font-weight:600}
    #recipe-index a:hover{color:var(--brand);text-decoration:underline}

    .recipe{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px;margin:18px 0}
    .recipe h3{margin-top:0}
    .recipe .meta{color:var(--muted);font-size:.9rem;margin-top:-6px}
    .recipe mark{padding:0 .15em;border-radius:4px}

    footer{text-align:center;padding:18px;background:#444;color:#fff;margin-top:32px}

    /* a11y focus */
    a:focus,button:focus,input:focus{outline:3px solid rgba(255,19,240,.45);outline-offset:2px}

    /* util */
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
      /* Category pills */
    .pill-group{display:flex;gap:8px;flex-wrap:wrap}
    .pill{padding:8px 12px;border-radius:999px;background:#fff;border:1px solid #ccc;box-shadow:var(--shadow);cursor:pointer;font-size:.95rem}
    .pill[aria-pressed="true"]{background:var(--brand);color:#fff;border-color:transparent}
    .pill:focus{outline:3px solid rgba(255,19,240,.45);outline-offset:2px}
  </style>
</head>
<body>
  <header>
    <h1>Efrem Raimondo's Cookbook</h1>
    <p>No‑nonsense instructions to save your cooking (and your sanity).</p>
  </header>

  <main class="container">
    <div class="tools" role="search">
      <label for="search-bar" class="sr-only">Search recipes</label>
      <input id="search-bar" type="search" placeholder="Search recipes, ingredients…" autocomplete="off" aria-describedby="count" />
      <div id="count" aria-live="polite"></div>
      <nav aria-label="Categories" class="pill-group" id="categories"></nav>
    </div>
    </div>

    <section id="index" aria-labelledby="index-title">
      <h2 id="index-title">Index</h2>
      <ul id="recipe-index"></ul>
    </section>

    <section id="recipes" aria-labelledby="recipes-title">
      <h2 id="recipes-title">Recipes</h2>
      <div id="recipe-list"></div>
    </section>
  </main>

  <footer>
    <p>&copy; <span id="year"></span> Efrem Raimondo's Cookbook</p>
  </footer>

  <script>
    // --- Data (your original content kept) ---
    const recipes = [
      {
        title: "Beurre Café de Paris",
        categories: ["Sauce"],
        ingredients: [
          "3 scallions, thinly sliced",
          "1 clove of garlic",
          "2 teaspoons of mustard",
          "2 anchovies",
          "6 teaspoons of Worcestershire sauce",
          "Parsley, chopped",
          "Zest of 1 lemon",
          "5 teaspoons of lemon juice",
          "1/2 stick of butter"
        ],
        instructions: `
          Thinly slice the 3 scallions. Melt part of the butter in a skillet and sauté the scallions until soft and lightly golden. Remove from heat and allow to cool.

          In a blender, combine the garlic clove, anchovies, parsley, mustard, Worcestershire sauce, lemon zest, lemon juice, and the remaining fresh butter. Add the sautéed scallions and blend everything together until smooth.

          Blend until the mixture reaches a creamy, homogenous consistency. Add a pinch of salt to taste. Refrigerate before serving.
        `
      },
      {
        title: "Filetto al Pepe Verde",
        categories: ["Meat","Beef"],
        ingredients: [
          "800 g whole beef tenderloin",
          "30 g green peppercorns in brine",
          "100 g fresh liquid cream",
          "50 g Dijon mustard",
          "120 g hot beef broth",
          "30 g brandy",
          "40 g clarified butter",
          "Salt, to taste",
          "All-purpose flour, as needed"
        ],
        instructions: `
          Clean the tenderloin and cut it into 4 medallions of 200 g each. Tie each medallion with kitchen twine to maintain their shape. Lightly flour both sides of each medallion.

          Heat the clarified butter in a skillet over medium-high heat and sear the medallions for 2 minutes on each side. Deglaze the pan with brandy and flambé, or allow the alcohol to evaporate.

          Lower the heat and add the drained green peppercorns, Dijon mustard, 50 g of cream, and 50 g of beef broth. Cook for another 2 minutes on each side, basting the meat with the sauce.

          Remove the medallions and let them rest. In the same skillet, add the remaining cream and broth, and reduce the sauce until thickened.

          Return the medallions to the skillet for a few seconds, coat them with the sauce, and serve immediately.
        `
      },
      {
        title: "Poulet Crémeux à la Dijon",
        categories: ["Meat","Chicken"],
        ingredients: [
          "150 g roasted potatoes (oven or air fryer)",
          "175 g chicken breast or thigh, raw",
          "1/2 onion, chopped",
          "2 garlic cloves, minced",
          "2 shallots (optional)",
          "1 teaspoon olive oil",
          "Bay leaf, to taste",
          "2 teaspoons onion powder",
          "2 teaspoons paprika",
          "2 teaspoons Italian seasoning",
          "2 teaspoons salt and black pepper (adjust to taste)",
          "2 teaspoons Dijon mustard",
          "1 cup vegetable or chicken broth",
          "1/2 cup light cream",
          "1/2 cup milk of choice",
          "Fresh parsley for garnish"
        ],
        instructions: `
          Roast the potatoes in the oven or air fryer at 200°C (390°F) for 20 minutes.

          In a skillet or pot over high heat, add olive oil, chicken, and halved shallots (if using). Season with salt, black pepper, paprika, onion powder, Italian seasoning, and a bay leaf. Grill the chicken until fully cooked, approximately 10-12 minutes. Remove and set aside.

          Lower the heat to medium, and in the same skillet, add minced garlic, chopped onion, paprika, Italian seasoning, and Dijon mustard. Sauté until the onion becomes translucent and fragrant, about 2-3 minutes.

          Pour in the vegetable or chicken broth, light cream, and milk. Mix well to combine all the ingredients. Let the sauce simmer for 5 minutes, allowing the flavors to blend and the sauce to thicken slightly.

          Remove the skillet from the heat and return the chicken and shallots to the sauce. Garnish with fresh parsley leaves.

          Serve the creamy Dijon chicken with the roasted potatoes. Enjoy your meal!
        `
      },
      {
        title: "Pasta",
        categories: ["Pasta"],
        ingredients: [
          "300 g of flour",
          "100 g of water + 1 egg (or 150 g of water if not using an egg)",
          "A pinch of salt",
        ],
        instructions: `
          In a large bowl, combine the flour and a pinch of salt.
          If using an egg, lightly beat it and mix it with 100 g of water. If you prefer egg-free pasta, use an additional 50 g of water.
          Create a well in the center of the flour and pour in the water (and the egg, if used). Start incorporating the flour into the liquids, mixing until a dough forms.
          Transfer the dough onto a lightly floured surface and knead for about 10 minutes until it becomes smooth and elastic. If the dough is too sticky, add a little more flour; if it’s too dry, add a small amount of water.
          Wrap the dough in plastic wrap (cling film) and let it rest in the refrigerator for 20 minutes. This resting time allows the gluten to relax, making the dough easier to roll out.
          After resting, divide the dough into smaller portions. Using a pasta machine, begin rolling out the dough at the widest setting, gradually decreasing the thickness until you reach setting number 4.
          Your pasta is now ready to be used in your favorite recipe. Cut it into your desired shape or use it as sheets for lasagna.
        `
      },
      {
        title: "Gnocchi",
        categories: ["Pasta"],
        ingredients: [
          "4 large potatoes (about 800 g)",
          "All-purpose flour (as needed, about 200–300 g)",
          "Salt, to taste"
        ],
        instructions: `
          Place the potatoes in a large pot of salted water. Bring to a boil and cook until tender, about 20–25 minutes. A fork should easily pierce through them.

          Once cooked, drain the potatoes and let them cool slightly. Peel the potatoes and mash them thoroughly until you achieve a smooth consistency.

          Gradually add the flour to the mashed potatoes along with a pinch of salt. Mix until the dough is no longer sticky but still soft and workable. Avoid overworking the dough.

          Divide the dough into smaller portions. Roll each portion into a long, thin rope about 2 centimeters in diameter. Cut each rope into small pieces, about 2 centimeters long.

          Gently press each piece onto the tines of a fork, rolling it slightly to create ridges. This texture helps the sauce adhere better to the gnocchi.

          Bring a large pot of salted water to a boil. Cook the gnocchi in small batches until they float to the surface, about 2–3 minutes.

          Remove the gnocchi with a slotted spoon and serve immediately with your preferred sauce.
        `
      },
      {
        title: "Pizza",
        categories: ["Bread","Main"],
        ingredients: [
          "250 ml lukewarm water",
          "400 g all-purpose flour",
          "2 tablespoons olive oil",
          "3 teaspoons salt",
          "1 teaspoon granulated sugar",
          "1 tablespoon dry yeast or 1/4 block of fresh yeast"
        ],
        instructions: `
          In a bowl, dissolve the yeast (dry or fresh) in the lukewarm water with the sugar. Let it rest for a few minutes until the yeast begins to foam.

          Gradually add the flour to the bowl, mixing by hand as you go. Continue adding and mixing until a dough forms.

          Add the salt and olive oil to the dough and continue mixing by hand until all ingredients are fully incorporated.

          Transfer the dough to a lightly floured surface and knead by hand for about 10 minutes, using the palms of your hands to push the dough forward, then folding it back and turning slightly each time, until it becomes smooth and elastic.

          Place the dough in a bowl lightly greased with olive oil, cover it with plastic wrap, and let it rise in a warm place for about 1–2 hours, or until it doubles in size.

          Once the dough has risen, gently deflate it with your hands and transfer it to a lightly floured surface.

          Roll out the dough with your hands to achieve the desired shape and thickness.

          Add your preferred toppings to the surface of the dough.

          Bake in a preheated oven at 170°C (340°F) for 20–25 minutes, or until the pizza is golden and crispy.
        `
      }
    ];

    // --- Helpers ---
    let selectedCategory = 'All';

    // (Restored) original helpers
    const slug = s => s.toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,'');
    const escapeHtml = s => s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[c]));

    function highlight(text, term){
      if(!term) return escapeHtml(text);
      const safe = term.replace(/[.*+?^${}()|[\]\]/g,'\$&');
      return escapeHtml(text).replace(new RegExp(`(${safe})`,`ig`), '<mark>$1</mark>');
    }

    function debounced(fn, wait=120){
      let t;return (...args)=>{clearTimeout(t);t=setTimeout(()=>fn(...args),wait)}
    }

    // (New) category helpers
    function collectCategories(list){
      const set = new Set(['All']);
      list.forEach(r=>{
        (r.categories||['Uncategorized']).forEach(c=> set.add(c));
      });
      return Array.from(set);
    }

    function renderCategories(list){
      const nav = document.getElementById('categories');
      nav.innerHTML = '';
      const cats = collectCategories(list);
      cats.forEach(c=>{
        const b = document.createElement('button');
        b.className = 'pill';
        b.type = 'button';
        b.textContent = c;
        b.setAttribute('aria-pressed', String(c===selectedCategory));
        b.addEventListener('click', ()=>{
          selectedCategory = c;
          update();
        });
        nav.appendChild(b);
      });
    }

    // --- Render index ---
    function renderIndex(list){
      const ul = document.getElementById('recipe-index');
      ul.innerHTML = '';
      list.forEach(r=>{
        const id = slug(r.title);
        const li = document.createElement('li');
        li.innerHTML = `<a href="#${id}">${escapeHtml(r.title)}</a>`;
        ul.appendChild(li);
      });
      document.getElementById('count').textContent = `${list.length} recipe${list.length===1?'':'s'}`;
    }

    // --- Render recipes ---
    function renderRecipes(list, term=''){
      const wrap = document.getElementById('recipe-list');
      wrap.innerHTML = '';
      list.forEach(r=>{
        const id = slug(r.title);
        const art = document.createElement('article');
        art.className = 'recipe';
        art.id = id;
        const ing = r.ingredients.map(i=>`<li>${highlight(i, term)}</li>`).join('');
        art.innerHTML = `
          <h3>${highlight(r.title, term)}</h3>
          <div class="meta">${r.ingredients.length} ingredients</div>
          <h4>Ingredients</h4>
          <ul>${ing}</ul>
          <h4>Instructions</h4>
          <p>${highlight(r.instructions.trim(), term).replace(/\n\n/g,'</p><p>')}</p>
        `;
        wrap.appendChild(art);
      });
    }

    // --- Search + filter ---
    function filter(list, q){
      const matchSearch = (r)=>{
        if(!q) return true;
        const t = q.toLowerCase();
        return r.title.toLowerCase().includes(t) ||
          (r.categories||[]).some(cat=>cat.toLowerCase().includes(t)) ||
          r.ingredients.some(i=>i.toLowerCase().includes(t)) ||
          r.instructions.toLowerCase().includes(t);
      };
      const matchCat = (r)=> selectedCategory==='All' ? true : (r.categories||['Uncategorized']).includes(selectedCategory);
      return list.filter(r=> matchSearch(r) && matchCat(r));
    }

    const onSearch = debounced(()=>{ update(); }, 150);
      const filtered = filter(recipes, q);
      renderIndex(filtered);
      renderRecipes(filtered, q);
      if(location.hash){ // keep focus on selection after search
        const target = document.querySelector(location.hash);
        if(target) target.scrollIntoView({behavior:'smooth', block:'start'});
      }
    }, 150);

    // --- Hash navigation ---
    function handleHash(){
      const id = location.hash.replace('#','');
      if(!id) return;
      const target = document.getElementById(id);
      if(target){ target.scrollIntoView({behavior:'smooth', block:'start'}); target.tabIndex = -1; target.focus({preventScroll:true}); }
    }

    // --- Boot & update ---
    function update(){
      const q = document.getElementById('search-bar').value.trim();
      const filtered = filter(recipes, q);
      renderCategories(recipes); // keep buttons; reset pressed state
      // re-mark selected state
      [...document.querySelectorAll('#categories .pill')].forEach(b=> b.setAttribute('aria-pressed', String(b.textContent===selectedCategory)));
      renderIndex(filtered);
      renderRecipes(filtered, q);
      if(location.hash){
        const target = document.querySelector(location.hash);
        if(target) target.scrollIntoView({behavior:'smooth', block:'start'});
      }
    }

    (function init(){
      document.getElementById('year').textContent = new Date().getFullYear();
      renderCategories(recipes);
      renderIndex(recipes);
      renderRecipes(recipes);
      document.getElementById('search-bar').addEventListener('input', onSearch);
      window.addEventListener('hashchange', handleHash);
      handleHash();
    })();
  </script>

  <!-- Optional schema to help SEO: simple ItemList of recipe anchors -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "ItemList",
    "itemListElement": [
      { "@type": "ListItem", "position": 1, "url": "#beurre-cafe-de-paris" },
      { "@type": "ListItem", "position": 2, "url": "#filetto-al-pepe-verde" },
      { "@type": "ListItem", "position": 3, "url": "#poulet-cremeux-a-la-dijon" },
      { "@type": "ListItem", "position": 4, "url": "#pasta" },
      { "@type": "ListItem", "position": 5, "url": "#gnocchi" },
      { "@type": "ListItem", "position": 6, "url": "#pizza" }
    ]
  }
  </script>
</body>
</html>
